;(function(e){e(function(){function i(t){function u(e){var t=f();t.fulfill(e);return t.promise}function a(e){var t=f();t.reject(e);return t.promise}function f(){function f(t,n){a=a||typeof n==="function";var r=e();u(t,n,r);return r.promise}function h(e,t){if(!o){return}var n=o;o=r;u=function(n,r,s){i(function(){e(t,n,r,s.fulfill,s.reject)})};i(function(){n.forEach(function(n){n(e,t)})})}var t,n,o,u,a;n=p(f);t={promise:n,fulfill:function(e){h(l,e)},reject:function(e){if(a===false){a=true;s(e,n)}h(c,e)}};o=[];u=function(e,t,n){o.push(function(r,i){r(i,e,t,n.fulfill,n.reject)})};return t}function l(e,t,n,r,i){return h(e,t,r,r,i)}function c(e,t,n,r,i){return h(e,n,i,r,i)}function h(e,t,n,r,i){var s;try{if(typeof t==="function"){s=t(e);if(s&&typeof s.then==="function"){s.then(r,i)}else{r(s)}}else{n(e)}}catch(o){i(o)}}function p(e){return o({then:e})}var i,s,o;i=t.nextTick||n.nextTick;s=t.unhandled||n.unhandled;o=t.protect||n.protect;f.fulfilled=u;f.rejected=a;return f}function s(e){return e}function o(){}var e,t,n,r;t=typeof process==="object"?process.nextTick:typeof setImmediate==="function"?setImmediate:function(e){setTimeout(e,0)};n={nextTick:t,unhandled:o,protect:s};e=i(n);e.construct=i;return e})})(typeof define==="function"&&define.amd?define:function(e){avow=e()})
